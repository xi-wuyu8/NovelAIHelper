<!-- ./src/taskpane/taskpane.html -->
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>小说 AI 助手</title>
    <!-- Office JS API -->
    <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
    <!-- Fabric UI for styling -->
    <link rel="stylesheet" href="https://static2.sharepointonline.com/files/fabric/office-ui-fabric-core/11.0.0/css/fabric.min.css"/>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- Custom Stylesheet -->
    <link href="taskpane.css" rel="stylesheet" type="text/css" />
</head>
<body class="ms-font-m ms-Fabric">
    <!-- Main App Container -->
    <div id="app-container">
        <header>
            <div class="header-title">
                <i data-lucide="brain-circuit"></i>
                <h1>小说 AI 助手</h1>
            </div>
            <!-- API Settings Button -->
            <button id="settings-button" class="ms-Button ms-Button--icon" title="API 设置">
                <i data-lucide="settings" class="button-icon"></i>
            </button>
        </header>
        <main>
            <!-- Knowledge Base Section -->
            <section id="knowledge-base">
                <h2>知识库</h2>
                <ul id="file-list">
                    <!-- Knowledge base files will be listed here -->
                </ul>
                <button id="add-file-button" class="ms-Button">
                    <i data-lucide="folder-plus" class="button-icon"></i>
                    <span class="ms-Button-label">从电脑选择文件</span>
                </button>
                <input type="file" id="file-input" style="display: none;" accept=".docx,.md,.txt">
            </section>

            <!-- Selection Context Section -->
            <section id="selection-context">
                <h2>当前选中</h2>
                <div id="selected-text-display">
                    <p class="placeholder">请在文档中选择文本以进行编辑...</p>
                </div>
            </section>

            <!-- Chat Section -->
            <section id="chat-container">
                <div id="chat-history">
                    <div class="ai-message">你好！请在文档中选择文本进行快速编辑，或直接提问进行全文创作。</div>
                </div>
                <div id="input-area">
                    <textarea id="user-input" placeholder="输入指令或问题..."></textarea>
                    <button id="send-button" class="ms-Button ms-Button--primary">
                        <i data-lucide="send" class="button-icon"></i>
                    </button>
                </div>
            </section>
        </main>
        <footer>
            <p id="status-message">准备就绪</p>
        </footer>
    </div>
    
    <!-- API Settings Modal (Initially Hidden) -->
    <div id="settings-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>API 设置</h2>
                <button id="close-modal-button" class="ms-Button ms-Button--icon">
                    <i data-lucide="x"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="setting-item">
                    <label for="provider-select">AI 提供商</label>
                    <select id="provider-select">
                        <option value="gemini">Google Gemini</option>
                        <option value="openai">OpenAI</option>
                    </select>
                </div>
                <div class="setting-item">
                    <label for="api-key-input">API 密钥</label>
                    <input type="password" id="api-key-input" placeholder="输入您的 API 密钥...">
                </div>
                <div class="setting-item">
                    <label for="model-select">模型</label>
                    <select id="model-select">
                        <!-- Options are dynamically populated by JS -->
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button id="save-settings-button" class="ms-Button ms-Button--primary">
                    <span class="ms-Button-label">保存设置</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Main App Logic -->
    <script type="text/javascript" src="taskpane.js"></script>
</body>
</html>
